schema: '2.0'
stages:
  generate_data:
    cmd: python src/stages/generate_synthetic_data.py
    deps:
    - path: src/stages/generate_synthetic_data.py
      hash: md5
      md5: bede198743bb4081fd1adc04fa61d103
      size: 4350
    - path: src/utilities/data_utils.py
      hash: md5
      md5: 11399677f0c6324096c4f43346caa1fa
      size: 30081
    params:
      params.yaml:
        data:
          n_samples: 1000
          n_pred_samples: 100
          spacing: 50
          depth: -500
          n_features: 5
          n_classes: 5
          threshold_binary: 0.5
          min_samples_per_class: 20
          connection_radius: 150
          n_splits: 3
          test_size: 0.3
          calib_size: 0.5
          n_hotspots: 5
          n_hotspots_random: false
          seed: 3123
    outs:
    - path: results/data
      hash: md5
      md5: 27b5805f17a0eb01ebc3b65901e12d24.dir
      size: 39744319
      nfiles: 12
  train:
    cmd: python src/stages/train.py --model gat
    deps:
    - path: results/data
      hash: md5
      md5: 27b5805f17a0eb01ebc3b65901e12d24.dir
      size: 39744319
      nfiles: 12
    - path: src/models/
      hash: md5
      md5: 94dea62ac7af3b278224b13966558cbe.dir
      size: 23815
      nfiles: 10
    - path: src/stages/train.py
      hash: md5
      md5: f710d8b68f714e2439b58b676e06496f
      size: 3310
    - path: src/utilities/logging_utils.py
      hash: md5
      md5: 608e90f581f5c92d5b0396e6ae19b813
      size: 1081
    - path: src/utilities/train_utils.py
      hash: md5
      md5: e16cf2f5a466a15fcaf0ce32bd2d6fa5
      size: 11175
    params:
      params.yaml:
        model: gat
        models.gat:
          hidden_channels: 64
          n_layers: 3
          n_heads: 5
          dropout: 0.3
          batch_norm: true
        train:
          n_epochs: 1000
          lr: 0.001
          max_grad_norm: 1.0
          weight_decay_adam_optimizer: 0.0005
          factor_learning_rate_scheduler: 0.5
          patience_learning_rate_scheduler: 20
          patience_early_stopping: 50
          min_delta_early_stopping: 0.001
    outs:
    - path: results/trained
      hash: md5
      md5: fa324b5e0bcec4ac87e5a3403be08f5b.dir
      size: 2639466
      nfiles: 4
  evaluate:
    cmd: python src/stages/evaluate.py --model gat
    deps:
    - path: results/trained
      hash: md5
      md5: fa324b5e0bcec4ac87e5a3403be08f5b.dir
      size: 2639466
      nfiles: 4
    - path: src/models/
      hash: md5
      md5: 94dea62ac7af3b278224b13966558cbe.dir
      size: 23815
      nfiles: 10
    - path: src/stages/evaluate.py
      hash: md5
      md5: ed52fabd29d627143cdec52364fbd3ed
      size: 3548
    - path: src/utilities/calibration_utils.py
      hash: md5
      md5: dbf6b5f39da243e06e73694dc0f2de71
      size: 62546
    - path: src/utilities/eval_utils.py
      hash: md5
      md5: f6a0d60a4ccdae3fe2bc44bc524a7502
      size: 14574
    - path: src/utilities/logging_utils.py
      hash: md5
      md5: 608e90f581f5c92d5b0396e6ae19b813
      size: 1081
    params:
      params.yaml:
        evaluate:
          initial_temperature: 1.2
          n_bins: 10
          class_names:
          calibration_method: beta
          n_epochs: 1000
          lr: 0.001
          weight_decay_adam_optimizer: 0.0005
          verbose: true
          factor_learning_rate_scheduler: 0.4
          patience_learning_rate_scheduler: 20
          patience_early_stopping: 50
          min_delta_early_stopping: 0.001
          reg_lambda: 0.01
          reg_mu: 0.01
          eps: 1e-08
          seed: 40
    outs:
    - path: results/evaluation
      hash: md5
      md5: 3f977a6522c71ebd09c5bf6dd3aab7cc.dir
      size: 462047
      nfiles: 6
  predict:
    cmd: python src/stages/predict.py --model gat
    deps:
    - path: results/data
      hash: md5
      md5: 27b5805f17a0eb01ebc3b65901e12d24.dir
      size: 39744319
      nfiles: 12
    - path: results/evaluation
      hash: md5
      md5: 3f977a6522c71ebd09c5bf6dd3aab7cc.dir
      size: 462047
      nfiles: 6
    - path: src/models/
      hash: md5
      md5: 94dea62ac7af3b278224b13966558cbe.dir
      size: 23815
      nfiles: 10
    - path: src/stages/predict.py
      hash: md5
      md5: 28a3617f618958eaa8e5ce0b5b8a986c
      size: 1840
    - path: src/utilities/calibration_utils.py
      hash: md5
      md5: dbf6b5f39da243e06e73694dc0f2de71
      size: 62546
    - path: src/utilities/logging_utils.py
      hash: md5
      md5: 608e90f581f5c92d5b0396e6ae19b813
      size: 1081
    - path: src/utilities/pred_utils.py
      hash: md5
      md5: 06420917a84aa648a43ea75af1d5a9d6
      size: 3126
  analyze_drift:
    cmd: python src/stages/analyze_drift.py
    deps:
    - path: results/data
      hash: md5
      md5: 27b5805f17a0eb01ebc3b65901e12d24.dir
      size: 39744319
      nfiles: 12
    - path: src/models/
      hash: md5
      md5: 94dea62ac7af3b278224b13966558cbe.dir
      size: 23815
      nfiles: 10
    - path: src/stages/analyze_drift.py
      hash: md5
      md5: ee9580c5924f4ebd5334b0b0ac4a0495
      size: 1425
    - path: src/utilities/drift_detection_utils.py
      hash: md5
      md5: 863658e09baae4978e202450a96faa9c
      size: 26781
    - path: src/utilities/logging_utils.py
      hash: md5
      md5: 608e90f581f5c92d5b0396e6ae19b813
      size: 1081
    params:
      params.yaml:
        analyze_drift:
          n_permutations: 1000
          gamma:
    outs:
    - path: results/drift_analysis
      hash: md5
      md5: c0f2fd33524597d985a2088acd667808.dir
      size: 3145282
      nfiles: 5
