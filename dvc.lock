schema: '2.0'
stages:
  generate_data:
    cmd: python src/stages/generate_synthetic_data.py
    deps:
    - path: src/stages/generate_synthetic_data.py
      hash: md5
      md5: bede198743bb4081fd1adc04fa61d103
      size: 4350
    - path: src/utilities/data_utils.py
      hash: md5
      md5: 11399677f0c6324096c4f43346caa1fa
      size: 30081
    params:
      params.yaml:
        data:
          n_samples: 1000
          n_pred_samples: 100
          spacing: 50
          depth: -500
          n_features: 5
          n_classes: 5
          threshold_binary: 0.5
          min_samples_per_class: 20
          connection_radius: 150
          n_splits: 3
          test_size: 0.3
          calib_size: 0.5
          n_hotspots: 5
          n_hotspots_random: false
          seed: 3123
    outs:
    - path: results/data
      hash: md5
      md5: 27b5805f17a0eb01ebc3b65901e12d24.dir
      size: 39744319
      nfiles: 12
  train:
    cmd: python src/stages/train.py --model gat --cycle 5
    deps:
    - path: results/data/base/cycle_5
      hash: md5
      md5: baf9cf550d10330290c3326a9d56fdfe.dir
      size: 30309087
      nfiles: 9
    - path: src/models/
      hash: md5
      md5: b579ca83d516d64f5b9351c4f228d6d4.dir
      size: 23859
      nfiles: 10
    - path: src/stages/train.py
      hash: md5
      md5: da54fa604ab5eae81c825d67f5f79d44
      size: 3197
    - path: src/utilities/logging_utils.py
      hash: md5
      md5: 608e90f581f5c92d5b0396e6ae19b813
      size: 1081
    - path: src/utilities/train_utils.py
      hash: md5
      md5: af70972a092dafc97abf407df17b451c
      size: 11330
    params:
      params.yaml:
        cycle: 5
        model: gat
        models.gat:
          hidden_channels: 64
          n_layers: 3
          n_heads: 5
          dropout: 0.3
          batch_norm: true
        train:
          n_epochs: 1000
          lr: 0.001
          max_grad_norm: 1.0
          weight_decay_adam_optimizer: 0.0005
          factor_learning_rate_scheduler: 0.5
          patience_learning_rate_scheduler: 20
          patience_early_stopping: 50
          min_delta_early_stopping: 0.001
    outs:
    - path: results/trained/cycle_5
      hash: md5
      md5: 2c54b8eaf42df2e94e085658b13b0d23.dir
      size: 1834298
      nfiles: 3
  evaluate:
    cmd: python src/stages/evaluate.py --model gat --cycle 5
    deps:
    - path: results/trained/cycle_5
      hash: md5
      md5: 2c54b8eaf42df2e94e085658b13b0d23.dir
      size: 1834298
      nfiles: 3
    - path: src/models/
      hash: md5
      md5: b579ca83d516d64f5b9351c4f228d6d4.dir
      size: 23859
      nfiles: 10
    - path: src/stages/evaluate.py
      hash: md5
      md5: c89c6680da6986f1ec5e9af0b51af0ec
      size: 3456
    - path: src/utilities/calibration_utils.py
      hash: md5
      md5: a078e992c0b0cfbe9ca5fce8ccb6f97c
      size: 63093
    - path: src/utilities/eval_utils.py
      hash: md5
      md5: 9a07fe9ea3eed7195f8dad416862f15f
      size: 14914
    - path: src/utilities/logging_utils.py
      hash: md5
      md5: 608e90f581f5c92d5b0396e6ae19b813
      size: 1081
    params:
      params.yaml:
        cycle: 5
        evaluate:
          initial_temperature: 1.2
          n_bins: 10
          class_names:
          calibration_method: beta
          n_epochs: 1000
          lr: 0.001
          weight_decay_adam_optimizer: 0.0005
          verbose: true
          factor_learning_rate_scheduler: 0.4
          patience_learning_rate_scheduler: 20
          patience_early_stopping: 50
          min_delta_early_stopping: 0.001
          reg_lambda: 0.01
          reg_mu: 0.01
          eps: 1e-08
          seed: 40
    outs:
    - path: results/evaluation/cycle_5
      hash: md5
      md5: ef583fe498c2afe6e52564a7a591864a.dir
      size: 459244
      nfiles: 6
  predict:
    cmd: python src/stages/predict.py --model gat --cycle 5
    deps:
    - path: results/data/prediction/cycle_5
      hash: md5
      md5: 169546faae7d9759dab637ae9e5e0abc.dir
      size: 8540
      nfiles: 1
    - path: results/evaluation/cycle_5
      hash: md5
      md5: ef583fe498c2afe6e52564a7a591864a.dir
      size: 459244
      nfiles: 6
    - path: results/trained/cycle_5
      hash: md5
      md5: 2c54b8eaf42df2e94e085658b13b0d23.dir
      size: 1834298
      nfiles: 3
    - path: src/models/
      hash: md5
      md5: b579ca83d516d64f5b9351c4f228d6d4.dir
      size: 23859
      nfiles: 10
    - path: src/stages/predict.py
      hash: md5
      md5: 199c58720b5f9ccc104a5bda967dd74b
      size: 2138
    - path: src/utilities/calibration_utils.py
      hash: md5
      md5: a078e992c0b0cfbe9ca5fce8ccb6f97c
      size: 63093
    - path: src/utilities/logging_utils.py
      hash: md5
      md5: 608e90f581f5c92d5b0396e6ae19b813
      size: 1081
    - path: src/utilities/pred_utils.py
      hash: md5
      md5: a2bc526c4b5366608353eeb2f4e80059
      size: 3497
    params:
      params.yaml:
        cycle: 5
    outs:
    - path: results/prediction/cycle_5
      hash: md5
      md5: 05e205495e1878bf3bc1ceb405760e83.dir
      size: 167906
      nfiles: 3
  analyze_drift:
    cmd: python src/stages/analyze_drift.py --cycle 5
    deps:
    - path: results/data/base/cycle_5
      hash: md5
      md5: baf9cf550d10330290c3326a9d56fdfe.dir
      size: 30309087
      nfiles: 9
    - path: results/data/prediction/cycle_5
      hash: md5
      md5: 169546faae7d9759dab637ae9e5e0abc.dir
      size: 8540
      nfiles: 1
    - path: src/models/
      hash: md5
      md5: b579ca83d516d64f5b9351c4f228d6d4.dir
      size: 23859
      nfiles: 10
    - path: src/stages/analyze_drift.py
      hash: md5
      md5: 031a55750e6993bee0d4c0b2c0b8910a
      size: 1805
    - path: src/utilities/drift_detection_utils.py
      hash: md5
      md5: fcf0f1af9eaaec6f8a561075d9687682
      size: 27593
    - path: src/utilities/logging_utils.py
      hash: md5
      md5: 608e90f581f5c92d5b0396e6ae19b813
      size: 1081
    params:
      params.yaml:
        analyze_drift:
          n_permutations: 1000
          gamma:
        cycle: 5
    outs:
    - path: results/drift_analysis/cycle_5
      hash: md5
      md5: 33ae9f4bc58599c33dcf4b8b833b2f86.dir
      size: 3512526
      nfiles: 5
  generate_base_data:
    cmd: python src/stages/generate_base_data.py --cycle 5
    deps:
    - path: src/stages/generate_base_data.py
      hash: md5
      md5: 75ae172073f0e6795f7411db206b6158
      size: 6280
    - path: src/utilities/data_utils.py
      hash: md5
      md5: 84f6043643b77582736435ee6de75235
      size: 32120
    params:
      params.yaml:
        cycle: 5
        data:
          base:
            n_samples: 1000
            spacing: 50
            depth: -500
            n_features: 5
            n_classes: 5
            threshold_binary: 0.5
            min_samples_per_class: 20
            connection_radius: 150
            n_splits: 2
            test_size: 0.3
            calib_size: 0.5
            n_hotspots: 5
            n_hotspots_random: false
            seed: 2321
          pred:
            n_samples: 100
            spacing: 50
            depth: -500
            n_features: 5
            n_classes: 5
            threshold_binary: 0.5
            min_samples_per_class:
            connection_radius: 150
            n_hotspots: 5
            n_hotspots_random: false
            seed:
    outs:
    - path: results/data/base/cycle_5
      hash: md5
      md5: baf9cf550d10330290c3326a9d56fdfe.dir
      size: 30309087
      nfiles: 9
  generate_pred_data:
    cmd: python src/stages/generate_pred_data.py --cycle 5 && ls -l results/data/prediction/cycle_5
    deps:
    - path: results/data/base/cycle_5
      hash: md5
      md5: baf9cf550d10330290c3326a9d56fdfe.dir
      size: 30309087
      nfiles: 9
    - path: src/stages/generate_pred_data.py
      hash: md5
      md5: 4d215ae3bed72e64b671dd97238d901c
      size: 2773
    - path: src/utilities/data_utils.py
      hash: md5
      md5: 84f6043643b77582736435ee6de75235
      size: 32120
    params:
      params.yaml:
        cycle: 5
        data:
          base:
            n_samples: 1000
            spacing: 50
            depth: -500
            n_features: 5
            n_classes: 5
            threshold_binary: 0.5
            min_samples_per_class: 20
            connection_radius: 150
            n_splits: 2
            test_size: 0.3
            calib_size: 0.5
            n_hotspots: 5
            n_hotspots_random: false
            seed: 2321
          pred:
            n_samples: 100
            spacing: 50
            depth: -500
            n_features: 5
            n_classes: 5
            threshold_binary: 0.5
            min_samples_per_class:
            connection_radius: 150
            n_hotspots: 5
            n_hotspots_random: false
            seed:
    outs:
    - path: results/data/prediction/cycle_5
      hash: md5
      md5: 169546faae7d9759dab637ae9e5e0abc.dir
      size: 8540
      nfiles: 1
  combine_data:
    cmd: python src/stages/combine_data.py --cycle 5
    deps:
    - path: results/data/base/cycle_5
      hash: md5
      md5: baf9cf550d10330290c3326a9d56fdfe.dir
      size: 30309087
      nfiles: 9
    - path: results/data/prediction/cycle_5
      hash: md5
      md5: 169546faae7d9759dab637ae9e5e0abc.dir
      size: 8540
      nfiles: 1
    - path: src/stages/combine_data.py
      hash: md5
      md5: 0a8a5c542894a2f48b7e05b7d32b34a1
      size: 4053
    - path: src/utilities/data_utils.py
      hash: md5
      md5: 84f6043643b77582736435ee6de75235
      size: 32120
    params:
      params.yaml:
        cycle: 5
        data:
          base:
            n_samples: 1000
            spacing: 50
            depth: -500
            n_features: 5
            n_classes: 5
            threshold_binary: 0.5
            min_samples_per_class: 20
            connection_radius: 150
            n_splits: 2
            test_size: 0.3
            calib_size: 0.5
            n_hotspots: 5
            n_hotspots_random: false
            seed: 2321
          pred:
            n_samples: 100
            spacing: 50
            depth: -500
            n_features: 5
            n_classes: 5
            threshold_binary: 0.5
            min_samples_per_class:
            connection_radius: 150
            n_hotspots: 5
            n_hotspots_random: false
            seed:
    outs:
    - path: results/data/combined/cycle_5
      hash: md5
      md5: 16443d754410f4c6dde92a426a73e395.dir
      size: 1298050
      nfiles: 1
